{%- assign tag = ""                              -%}

{%- assign primes = primes | push: num           -%}
{%- assign order = primes | size                 -%}

{%- if primes contains order                     -%}
{%-   unless parts                               -%}
{%-     assign parts = '' | split: ','           -%}
{%-   endunless                                  -%}
{%-   assign parts = parts | push: order         -%}
{%-   assign width = parts | size                -%}

{%-   if _keys contains width                    -%}
{%-     assign tag = "*"                         -%}
{%-   endif                                      -%}

{%-   if parts contains width                    -%}
{%-     unless bond                              -%}
{%-       assign bond = '' | split: ','          -%}
{%-     endunless                                -%}
{%-     assign bond = bond | push: width         -%}
{%-     assign weight = bond | size              -%}

{%-     if bond contains weight                  -%}
{%-       unless arm                             -%}
{%-         assign arm = '' | split: ','         -%}
{%-       endunless                              -%}
{%-       assign arm = arm | push: weight        -%}
{%-	      assign expanse = arm | size            -%}

{%-	      if arm contains expanse                -%}
{%-         unless id                            -%}
{%-           assign id = '' | split: ','        -%}
{%-         endunless                            -%}
{%-	        assign id = id | push: expanse       -%}
{%-	        assign property = id | size          -%}

{%-	        if id contains property              -%}
{%-           unless grammar                     -%}
{%-             assign grammar = '' | split: ',' -%}
{%-           endunless                          -%}
{%-           include core/_parts.liquid         -%}

{%-	        endif                                -%}
{%-	      endif                                  -%}
{%-	    endif                                    -%}
{%-   endif                                      -%}

{%-   assign array = '' | split: ','             -%}
{%-   if parts                                   -%}
{%-     assign array = array | push: parts       -%}
{%-   endif                                      -%}
{%-   if bond                                    -%}
{%-     assign array = array | push: bond        -%}
{%-   endif                                      -%}
{%-   if arm                                     -%}
{%-     assign array = array | push: arm         -%}
{%-   endif                                      -%}
{%-   if id                                      -%}
{%-     assign array = array | push: id          -%}
{%-   endif                                      -%}

{%-   for item in grammar                        -%}
{%-     assign array = array | push: item        -%}
{%-   endfor                                     -%}

{%-	  assign property = id | size | default: 0   -%}
{%-	  assign expanse = arm | size | default: 0   -%}
{%-   assign weight = bond | size | default: 0   -%}
{%-   assign width = parts | size | default: 0   -%}

{%-   include core/node.liquid                   -%}

{%-   assign array_size = array | size           -%}
{%-   assign layer_size = array[layer] | size    -%}

{%-   if layer_size == 10                        -%}

{%-     assign node_type = "main"                -%}
{%-     include core/_node.liquid                -%}

{%-   elsif keys contains width                  -%}

{%-     assign node_type = "lexer"               -%}
{%-     include core/_node.liquid                -%}

{%-   endif                                      -%}

{%- endif                                        -%}

