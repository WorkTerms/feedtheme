{%- assign tag = "[]"                     -%}

{%- assign primes = primes | push: num    -%}
{%- assign order = primes | size          -%}

{%- if primes contains order              -%}

{%-   unless parts                        -%}
{%-     assign parts = '' | split: ','    -%}
{%-   endunless                           -%}

{%-   assign parts = parts | push: order  -%}
{%-   assign width = parts | size         -%}
{%-   assign probe = width                -%}

{%-   if _keys contains width             -%}
{%-     assign tag = "[]*"                -%}
{%-   endif                               -%}

{%-   if parts contains probe             -%}
{%-       unless exp                      -%}
{%-         assign exp = '' | split: ','  -%}
{%-       endunless                       -%}
{%-     include core/_bond.liquid         -%}
{%-   endif                               -%}

{%-   if num > 1000 and order < _brake    -%}
{%-     include core/_parts.liquid        -%}
{%-   endif                               -%}

{%- endif                                 -%}

{%- if num < 1000 or order >= _brake      -%}
{%-   include core/_parts.liquid          -%}
{%- endif                                 -%}
