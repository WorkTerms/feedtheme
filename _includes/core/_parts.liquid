{%- include primes/grammar.liquid          -%}
{%- assign grammar = _grammar  | jsonify   -%}

{%- assign details = '('
       | append: bond
       | append: ','
       | append: lexer
       | append: ','
       | append: parser
       | append: ','
       | append: syntax
       | append: ')'
       | append: grammar                   -%}

{%- for prime in primes                    -%}
{%-   assign loop = forloop.index          -%}
{%-   if id <= prime                       -%}
{%-     break                              -%}
{%-   endif                                -%}
{%- endfor                                 -%}

{%- assign stage = '[' 
       | append: num       
       | append: ';'
       | append: order                
       | append: ']'                       -%}

{%- for item in array                      -%}
{%-   assign size = item | size            -%}
{%-   if forloop.first                     -%}
{%-     assign stage = stage
           | append: '('
           | append: size                  -%}
{%-   else                                 -%}
{%-     assign stage = stage
           | append: ';'
           | append: size                  -%}
{%-   endif                                -%}
{%- endfor                                 -%}

{%- assign stage = stage 
	   | append: ')'                       -%}

{%- include core/node.liquid               -%}
