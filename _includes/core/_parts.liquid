{%-   assign id = id | plus: 1                       -%}
{%-   assign array = '' | split: ','                 -%}

{%-   if parts                                       -%}
{%-     assign array = array | push: parts           -%}
{%-   endif                                          -%}
{%-   if bond                                        -%}
{%-     assign array = array | push: bond            -%}
{%-   endif                                          -%}
{%-   if arm                                         -%}
{%-     assign array = array | push: arm             -%}
{%-   endif                                          -%}
{%-   if eq                                          -%}
{%-     assign array = array | push: eq              -%}
{%-   endif                                          -%}

{%-   for item in grammar                            -%}
{%-     assign array = array | push: item            -%}
{%-   endfor                                         -%}

{%-   assign tag = array reversed | jsonify        -%}
{%-   assign width = parts | size | default: 0       -%}
{%-   assign weight = bond | size | default: 0       -%}
{%-	  assign expanse = arm | size | default: 0       -%}
{%-	  assign property = eq | size | default: 0       -%}

{%-   assign layer_size = array[layer] | size        -%}
{%-   assign array_size = array | size | default: 0  -%}

{%-   include core/node.liquid                       -%}

{%-   if _stage contains id                          -%}

{%-     assign node_type = "main"                    -%}
{%-     assign layer = layer | plus: 1               -%}
{%-     include core/_node.liquid                    -%}

{%-   elsif _branch contains id                      -%}

{%-     assign node_type = "brach"                   -%}
{%-     include core/_node.liquid                    -%}

{%-   endif                                          -%}
